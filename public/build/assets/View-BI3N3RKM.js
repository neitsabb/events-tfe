import{r as a,j as e,Y as w,a as j}from"./app-DXmYKjII.js";import{C as S,a as E,M as k}from"./CustomerLayout-BYig5w70.js";import{B as v}from"./button-LZ4wRFbW.js";import{P as M,a as P,b as L,C as U,c as $,d as O,e as R,f as z,g as I}from"./command-BjTOFcb1.js";import{EventCard as B}from"./View-DeZ7qpp4.js";import{c as C}from"./createLucideIcon-CPppSJ9e.js";import"./x-CVOJgJrA.js";import"./index-C6-qIfEc.js";import"./index-BuPIZ-AS.js";import"./index-CetX8bG5.js";import"./index-DjScTqDP.js";import"./dialog-D9adzbkq.js";import"./format-C8Xkf-na.js";import"./fr-CXO3BpIY.js";/**
 * @license lucide-react v0.419.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const V=C("Building",[["rect",{width:"16",height:"20",x:"4",y:"2",rx:"2",ry:"2",key:"76otgf"}],["path",{d:"M9 22v-4h6v4",key:"r93iot"}],["path",{d:"M8 6h.01",key:"1dz90k"}],["path",{d:"M16 6h.01",key:"1x0f13"}],["path",{d:"M12 6h.01",key:"1vi96p"}],["path",{d:"M12 10h.01",key:"1nrarc"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M16 10h.01",key:"1m94wz"}],["path",{d:"M16 14h.01",key:"1gbofw"}],["path",{d:"M8 10h.01",key:"19clt8"}],["path",{d:"M8 14h.01",key:"6423bh"}]]);/**
 * @license lucide-react v0.419.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const D=C("ChevronsUpDown",[["path",{d:"m7 15 5 5 5-5",key:"1hf1tw"}],["path",{d:"m7 9 5-5 5 5",key:"sgt6xg"}]]),se=()=>{const[i,n]=a.useState([]),[g,x]=a.useState([]),[u,m]=a.useState([]),[c,h]=a.useState(""),[r,l]=a.useState(!1),b=s=>new URLSearchParams(window.location.search).get(s);a.useEffect(()=>{const s=b("city");s?fetch(`${route("api.events.index")}?city=${s}`).then(t=>t.json()).then(t=>{h(s),n(t.events),x(t.cities),m(t.nearestCities),l(!0)}).catch(t=>console.error("Erreur lors de la récupération des événements",t)):!r&&navigator.geolocation?navigator.geolocation.getCurrentPosition(t=>{const{latitude:o,longitude:p}=t.coords,f=new URL(window.location.href);f.searchParams.set("latitude",o.toString()),f.searchParams.set("longitude",p.toString()),window.history.pushState({},"",f.toString()),fetch(`${route("api.events.index")}?latitude=${o}&longitude=${p}`).then(d=>d.json()).then(d=>{l(!0),n(d.events),x(d.cities),m(d.nearestCities),h(d.selectedCity)})},t=>{console.error("Erreur de géolocalisation",t),l(!0)}):l(!0)},[r]);const N=s=>{l(!1);const t=new URL(window.location.href);t.searchParams.set("city",s),window.history.pushState({},"",t.toString()),fetch(`${route("api.events.index")}?city=${s}`).then(o=>o.json()).then(o=>{h(s),n(o.events),m(o.nearestCities),l(!0)}).catch(o=>console.error("Erreur lors de la récupération des événements",o))};return e.jsxs(S,{children:[e.jsx(w,{title:"Événements"}),e.jsx("div",{className:"z-auto w-full",children:e.jsxs(E,{className:"relative z-10 mb-32",children:[e.jsxs("header",{className:"space-y-6 pt-16 pb-16",children:[e.jsxs("h2",{className:"text-3xl md:text-6xl font-bold flex flex-col md:flex-row md:items-center md:gap-4",children:["EVENEMENTS À"," ",r?e.jsx(T,{cities:g,defaultCity:c,onCityChange:N}):e.jsx("span",{className:"animate-pulse bg-gray-200/50 h-9 w-48 md:h-14 md:w-80 "})]}),e.jsx(j,{href:route("dashboard"),className:"block",children:e.jsxs(v,{variant:"customer_blue",children:["PUBLIER MON EVENEMENT",e.jsx(k,{size:16,strokeWidth:3,className:"ml-2"})]})})]}),r?Object.entries(i).length>0?Object.entries(i).map(([s,t],o)=>e.jsx(y,{title:e.jsx("h2",{className:"font-bold text-2xl",children:s}),children:e.jsx("div",{className:"grid grid-cols-1 gap-6 md:grid-cols-2 lg:grid-cols-3",children:t.map(p=>e.jsx(B,{event:p},p.id))})},o)):"Aucun événement trouvé":e.jsx(_,{}),e.jsx(y,{title:e.jsxs("h2",{className:"font-bold text-4xl !mt-16",children:["VILLES PROCHE DE ",c.toUpperCase()]}),children:e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-5 !my-16",children:u.filter(s=>s.city!==c).map((s,t)=>e.jsxs(j,{href:`${route("customer.events.index")}?city=${s.city}`,className:"p-6 text-primary flex flex-col gap-1 justify-center items-center border [&:not(:last-child)]:border-b-0 md:[&:not(:first-child)]:border-l md:border-b-0 md:border-t-0 md:border-0 border-dashed border-primary",children:[e.jsx(V,{strokeWidth:2,size:24}),e.jsx("h3",{className:"text-xl font-bold",children:s.city}),e.jsxs("p",{className:"font-mono lowercase text-sm",children:[s.event_count," événements"]})]},t))})})]})})]})},y=({title:i,children:n})=>e.jsxs("section",{className:"space-y-6 mb-8",children:[i,n]}),T=({cities:i,defaultCity:n,onCityChange:g})=>{const[x,u]=a.useState(n),[m,c]=a.useState(!1);a.useEffect(()=>{u(n)},[n]);const h=r=>{u(r),c(!1),g(r)};return e.jsxs(M,{open:m,onOpenChange:c,children:[e.jsx(P,{asChild:!0,children:e.jsxs(v,{variant:"none",className:"flex items-center justify-start md:justify-between gap-2",children:[e.jsx("span",{className:"text-4xl md:text-6xl font-bold text-primary",children:x}),e.jsx(D,{className:"opacity-50 pt-2 md:mt-4"})]})}),e.jsx(L,{className:"p-0 shadow-none rounded-none",side:"bottom",sideOffset:20,children:e.jsxs(U,{className:"border-2 rounded-none",children:[e.jsx($,{placeholder:"Rechercher une ville ...",className:"h-9 rounded-none font-mono"}),e.jsxs(O,{className:"border-t-2",children:[e.jsx(R,{children:"No city found."}),e.jsx(z,{className:"font-integral",children:i.map(r=>e.jsx(I,{value:r,onSelect:()=>h(r),children:r},r))})]})]})})]})},_=()=>e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"animate-pulse bg-gray-200/50 h-8 mb-6 w-48 block"}),e.jsx("div",{className:"grid grid-cols-1 gap-6 md:grid-cols-2 lg:grid-cols-3",children:[...Array(6)].map((i,n)=>e.jsx("div",{className:"bg-gray-200/50 animate-pulse h-56"},n))})]});export{se as default};
