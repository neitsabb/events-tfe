import{q as w,j as e,a as k}from"./app-BSg7tcV-.js";import{T as v}from"./Title-D8vjgEtZ.js";import{A as I,a as S,b as T}from"./avatar-ButMWc8x.js";import{B as X}from"./button-CrsewIh4.js";import{C as g,a as D,b}from"./card-CJqWb7OU.js";import{C as O,B as A,a as _,X as B,b as L,c as R,d as V}from"./chart-DKRH7tLP.js";import{E as $}from"./EventSingleLayout-ChSxrfKP.js";import{a as E}from"./utils-B0fn8ihL.js";import{I as Y,a as q}from"./react-icons.esm-CCC4ONUB.js";import{c as z,e as H,t as d,g as y,m as M,a as p,b as F,d as N}from"./format-Byq5l0Xu.js";import{c as K,d as G,a as J}from"./GeneralStep-CluPZpyd.js";import{f as P}from"./fr-BPQ7ghFf.js";import"./index-B6FVuNCK.js";import"./index-Dhe9Iuj7.js";import"./index-Bb4qSo10.js";import"./index-ClP4U42c.js";import"./AdminHeader-CRV36qwl.js";import"./dialog-BHgiNgJn.js";import"./index-Ds_mV5rb.js";import"./badge-DiBsXd1D.js";import"./enums-0bE_G0vF.js";import"./label-CCQKrebs.js";import"./AuthenticatedLayout-D4oF8_0h.js";import"./select-81fZS2R4.js";import"./index-DxOe1-pG.js";import"./index-DYbuBnVH.js";import"./index-C1gOTv3o.js";import"./index-jbec320_.js";import"./createLucideIcon-Dgyn1mPU.js";import"./textarea-WMTxw_PN.js";import"./Field-B_QrgzO7.js";import"./use-toast-DL6Jf7Lj.js";import"./index-Dxh5GxJh.js";import"./chevron-right-9hEqs-4T.js";import"./index.esm-DQT5-vAg.js";import"./isSameDay-CmgISKQ8.js";import"./popover-Cbj3uuOo.js";import"./index.modern-CyBs9gLA.js";import"./command-B1qCJl_3.js";import"./x-CpmZOtQj.js";function U(s){return z(s,Date.now())}function Q(s,o,a){const h=F(),r=(a==null?void 0:a.locale)??h.locale??H,x=2520,n=K(s,o);if(isNaN(n))throw new RangeError("Invalid time value");const t=Object.assign({},a,{addSuffix:a==null?void 0:a.addSuffix,comparison:n});let u,f;n>0?(u=d(o),f=d(s)):(u=d(s),f=d(o));const l=G(f,u),C=(y(f)-y(u))/1e3,i=Math.round((l-C)/60);let m;if(i<2)return a!=null&&a.includeSeconds?l<5?r.formatDistance("lessThanXSeconds",5,t):l<10?r.formatDistance("lessThanXSeconds",10,t):l<20?r.formatDistance("lessThanXSeconds",20,t):l<40?r.formatDistance("halfAMinute",0,t):l<60?r.formatDistance("lessThanXMinutes",1,t):r.formatDistance("xMinutes",1,t):i===0?r.formatDistance("lessThanXMinutes",1,t):r.formatDistance("xMinutes",i,t);if(i<45)return r.formatDistance("xMinutes",i,t);if(i<90)return r.formatDistance("aboutXHours",1,t);if(i<M){const c=Math.round(i/60);return r.formatDistance("aboutXHours",c,t)}else{if(i<x)return r.formatDistance("xDays",1,t);if(i<p){const c=Math.round(i/M);return r.formatDistance("xDays",c,t)}else if(i<p*2)return m=Math.round(i/p),r.formatDistance("aboutXMonths",m,t)}if(m=J(f,u),m<12){const c=Math.round(i/p);return r.formatDistance("xMonths",c,t)}else{const c=m%12,j=Math.trunc(m/12);return c<3?r.formatDistance("aboutXYears",j,t):c<9?r.formatDistance("overXYears",j,t):r.formatDistance("almostXYears",j+1,t)}}function W(s,o){return Q(s,U(s),o)}const Z={value:{label:"Ventes",color:"hsl(var(--chart-primary))"}},ee=({title:s,value:o,percentage:a})=>e.jsxs(g,{children:[e.jsx(D,{className:"flex flex-row items-center justify-between",children:e.jsx(v,{title:s,level:"h4"})}),e.jsxs(b,{className:"space-y-1 flex items-center gap-2",children:[e.jsx("p",{className:"text-3xl font-semibold",children:o}),a&&e.jsx("p",{className:"text-sm text-muted-foreground",children:a})]})]}),te=({transactions:s})=>{const{event:o}=w().props;return e.jsx("ul",{className:"space-y-8",children:s.slice(-10).map(a=>e.jsx("li",{className:"group cursor-pointer",children:e.jsxs(k,{href:route("events.transactions.show",{event:o.id,transaction:a.id}),className:"flex flex-row items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs(I,{className:"w-11 h-11 hidden lg:block",children:[e.jsx(S,{src:a.userImage}),e.jsx(T,{children:e.jsx(Y,{className:"w-4 h-4"})})]}),e.jsxs("div",{children:[e.jsxs("p",{className:"font-medium text-sm truncate",children:[E(a.name)," a acheté"," ",a.tickets_count===1?"un":a.tickets_count," ","billet",a.tickets_count>1&&"s"]}),e.jsx("p",{className:"text-xs text-muted-foreground",children:W(a.created_at,{addSuffix:!0,locale:P})})]})]}),e.jsx(X,{variant:"link",className:"text-card-foreground/50 group-hover:translate-x-2 transition-transform",children:e.jsx(q,{className:"w-6 h-6"})})]})},a.id))})},qe=()=>{const{event:s}=w().props;console.log(s);const o=s.transactions.reduce((n,t)=>n+t.amount,0),a=Object.values(s.tickets.admissions).reduce((n,t)=>n+t.quantity,0),h=Object.values(s.tickets).flatMap(n=>Object.values(n)).reduce((n,t)=>n+t.quantity,0),r=[{title:"Revenus",value:`${o} €`},{title:"Participants",value:`${s.tickets.participants}`,percentage:`sur ${a} (capacité totale)`},{title:"Billets vendus",value:s.tickets.total_sold,percentage:`sur ${h}`},{title:"Jours restants",value:N(new Date(s.start_date),new Date),percentage:`jour${N(new Date(s.start_date),new Date)>1?"s":""} avant l'événement`}],x=Object.values(s.tickets).flatMap(n=>Object.values(n)).map(n=>({ticket:n.name,value:n.sold}));return e.jsxs($,{event:s,children:[e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 my-4",children:r.map((n,t)=>e.jsx(ee,{title:n.title,value:n.value,percentage:n.percentage},t))}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 w-full",children:[e.jsxs(g,{className:"col-span-2",children:[e.jsx(D,{children:e.jsx(v,{title:"Ventes par billets",level:"h4"})}),e.jsx(b,{children:e.jsx(O,{config:Z,children:e.jsxs(A,{accessibilityLayer:!0,data:x,margin:{top:20},children:[e.jsx(_,{vertical:!1}),e.jsx(B,{dataKey:"ticket",tickLine:!1,tickMargin:10,axisLine:!1}),e.jsx(L,{cursor:!1,content:e.jsx(R,{hideLabel:!0})}),e.jsx(V,{dataKey:"value",fill:"var(--color-value)",radius:8,label:{position:"top"}})]})})})]}),e.jsxs(g,{children:[e.jsx(D,{children:e.jsx(v,{title:"Ventes récentes",level:"h4"})}),e.jsx(b,{children:e.jsx(te,{transactions:s.transactions})})]})]})]})};export{qe as default};
