import{q as z,r as p,j as e,y as n}from"./app-BSg7tcV-.js";import{A as j,c as f,d as v}from"./avatar-ButMWc8x.js";import{B as u}from"./button-CrsewIh4.js";import{I as A}from"./label-CCQKrebs.js";import{O as C}from"./OrganizationSettingsLayout-D450A3Qj.js";import{T as E}from"./react-icons.esm-CCC4ONUB.js";import{u as k}from"./use-toast-DL6Jf7Lj.js";import{S as I,a as U,b as V,c as L,e as T,d as h}from"./select-81fZS2R4.js";import{v as F}from"./utils-B0fn8ihL.js";import{F as g}from"./FormSection-MHh8IyQl.js";import{c as M}from"./createLucideIcon-Dgyn1mPU.js";import"./index-B6FVuNCK.js";import"./index-Dhe9Iuj7.js";import"./index-Bb4qSo10.js";import"./AuthenticatedLayout-D4oF8_0h.js";import"./dialog-BHgiNgJn.js";import"./index-Ds_mV5rb.js";import"./textarea-WMTxw_PN.js";import"./Field-B_QrgzO7.js";import"./index-DxOe1-pG.js";import"./index-DYbuBnVH.js";import"./index-C1gOTv3o.js";import"./index-Dxh5GxJh.js";import"./chevron-right-9hEqs-4T.js";import"./index-jbec320_.js";import"./SettingsLayout-CQP05J3d.js";import"./card-CJqWb7OU.js";/**
 * @license lucide-react v0.419.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const R=M("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]),B=({user:s,handleRoleChange:o,handleDeleteUser:a})=>{var l;return e.jsxs("li",{className:"flex flex-col md:flex-row gap-3 md:justify-between md:items-center py-5",children:[e.jsxs("div",{className:"flex min-w-0 gap-x-2",children:[e.jsxs(j,{className:"h-12 w-12 flex-none rounded-full bg-gray-50 grid place-content-center",children:[e.jsx(f,{children:((l=s.name)==null?void 0:l.charAt(0).toUpperCase())||"A"}),e.jsx(v,{src:s.picture})]}),e.jsxs("div",{className:"min-w-0 flex-auto",children:[e.jsx("p",{className:"text-sm font-semibold leading-6 text-gray-900",children:s.name||s.email}),e.jsx("p",{className:"mt-1 truncate text-xs leading-5 text-gray-500",children:s.name?s.email:"Cet utilisateur n’a pas encore complété son profil."})]})]}),e.jsxs("div",{className:"shrink-0 flex flex-col md:flex-row gap-2",children:[s.pivot.role!=="owner"&&e.jsxs(I,{defaultValue:s.pivot.role,onValueChange:i=>o(s.id,i),children:[e.jsx(U,{className:"w-full md:w-[140px]",children:e.jsx(V,{})}),e.jsx(L,{children:e.jsxs(T,{children:[e.jsx(h,{value:"member",children:"Membre"}),e.jsx(h,{value:"admin",children:"Administrateur"})]})})]}),e.jsx(u,{variant:"secondary",type:"button",onClick:()=>a(s.email),children:e.jsx(E,{className:"w-4 h-4"})})]})]},s.email)},D=({user:s,handleRemoveUser:o})=>{var a;return console.log(s),e.jsxs("li",{className:"flex justify-between items-center py-5",children:[e.jsxs("div",{className:"flex min-w-0 gap-x-2",children:[e.jsxs(j,{className:"h-12 w-12 flex-none rounded-full bg-gray-50 grid place-content-center",children:[e.jsx(f,{children:(a=s.name)==null?void 0:a.charAt(0).toUpperCase()}),e.jsx(v,{src:s.picture})]}),e.jsxs("div",{className:"min-w-0 flex-auto",children:[e.jsx("p",{className:"text-sm font-semibold leading-6 text-gray-900",children:s.name||"Anonyme"}),e.jsx("p",{className:"mt-1 truncate text-xs leading-5 text-gray-500",children:s.name==="Anonyme"?`${s.email} • Cet utilisateur recevra un e-mail pour compléter son profil.`:s.email})]})]}),e.jsx(u,{variant:"secondary",size:"sm",onClick:()=>o(s.email),children:"Supprimer"})]},s.email)},ue=()=>{const{toast:s}=k(),{auth:o}=z().props,[a,l]=p.useState([]),[i,x]=p.useState(""),[c,m]=p.useState(""),y=()=>{if(!i||o.organizationLogged.users.some(r=>r.email===i)||a.some(r=>r.email===i)){m("Cet utilisateur est déjà dans votre organisation.");return}if(!F(i)){m("Veuillez entrer une adresse e-mail valide.");return}n.post(route("organizations.invite.check"),{email:i},{preserveScroll:!0,onSuccess:({props:{flash:{user:r}}})=>{l([...a,typeof r=="object"?r:{email:i,name:"Anonyme"}]),x("")},onError:r=>console.error(r)})},S=r=>l(a.filter(t=>t.email!==r)),b=r=>{r.preventDefault(),n.post(route("organizations.invite"),{users:a.map(t=>t.email)},{preserveScroll:!0,onSuccess:({props:{flash:t}})=>{l([]),s({title:"Succès",description:t.success})},onError:t=>console.error(t)})},N=(r,t)=>{n.post(route("organizations.settings.update.role"),{userId:r,role:t},{preserveScroll:!0,onSuccess:({props:{flash:d}})=>{s({title:"Succès",description:d.success})},onError:d=>console.error(d)})},w=r=>{n.delete(route("organizations.delete.user",{email:r}),{preserveScroll:!0,onSuccess:({props:{flash:t}})=>{s({title:"Succès",description:t.success})},onError:t=>{s({title:"Erreur",description:t[0]})}})};return e.jsxs(C,{children:[e.jsx(g,{title:"Gérer les membres",description:"Vous pouvez ajouter des collaborateurs à votre organisation en entrant leur adresse e-mail ci-dessous.",disabled:!a.length,children:e.jsx("ul",{role:"list",className:"divide-y divide-gray-100",children:o.organizationLogged.users.map(r=>e.jsx(B,{user:r,handleRoleChange:N,handleDeleteUser:w},r.email))})}),e.jsxs(g,{title:"Ajouter des membres",description:"Vous pouvez ajouter des membres à votre organisation en entrant leur adresse e-mail ci-dessous.",disabled:!a.length,onSubmit:b,children:[e.jsxs("div",{className:"flex items-center gap-x-4",children:[e.jsx(A,{placeholder:"Entrez une adresse e-mail",value:i,onChange:r=>{x(r.target.value),m("")},className:c?"border-red-500 focus:ring-red-500 animate-shake":""}),e.jsx(u,{type:"button",onClick:y,size:"icon",className:"rounded-full shrink-0",children:e.jsx(R,{className:"w-4 h-4"})})]}),c&&e.jsx("p",{className:"text-xs text-red-600",children:c}),e.jsx("ul",{role:"list",className:"divide-y divide-gray-100",children:a.map(r=>e.jsx(D,{user:r,handleRemoveUser:S},r.email))})]})]})};export{ue as default};
