import{q as z,r as p,j as e,y as n}from"./app-CVF8BEhT.js";import{a as j,d as f,e as v}from"./AuthenticatedLayout-C0KxzASu.js";import{B as u,v as A}from"./button-DUi5mzVC.js";import{I as C}from"./label-Dco6ngRX.js";import{O as E}from"./OrganizationSettingsLayout-DujZ_Otc.js";import{T as k}from"./react-icons.esm-VOaCvzjC.js";import{u as I}from"./use-toast-Ks5kG8yd.js";import{S as U,a as V,b as L,c as T,e as F,d as h}from"./select-CS7rtfFQ.js";import{F as g}from"./FormSection-m8IZQ2qC.js";import{c as M}from"./createLucideIcon-Bd6W5ftE.js";import"./index-DxBV9s-K.js";import"./dialog-CxV-WXV2.js";import"./index-B3aS-FBJ.js";import"./textarea-DgwtjGM2.js";import"./Field-CLz6TGDR.js";import"./dropdown-menu-RQ8uIvFo.js";import"./chevron-right-74LANk0s.js";import"./index-CvlbXC3o.js";import"./index-D1AiXy-K.js";import"./check-c8eZV6AO.js";import"./SettingsLayout-DD1-SzRH.js";import"./index-CbT4m91Q.js";import"./card-pZ2PVDM0.js";/**
 * @license lucide-react v0.419.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const R=M("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]),ce=()=>{const{toast:s}=I(),{auth:o}=z().props,[a,l]=p.useState([]),[i,x]=p.useState(""),[c,m]=p.useState(""),y=()=>{if(!i||o.organizationLogged.users.some(r=>r.email===i)||a.some(r=>r.email===i)){m("Cet utilisateur est déjà dans votre organisation.");return}if(!A(i)){m("Veuillez entrer une adresse e-mail valide.");return}n.post(route("organizations.invite.check"),{email:i},{preserveScroll:!0,onSuccess:({props:{flash:{user:r}}})=>{l([...a,typeof r=="object"?r:{email:i,name:"Anonyme"}]),x("")},onError:r=>console.error(r)})},S=r=>l(a.filter(t=>t.email!==r)),b=r=>{r.preventDefault(),n.post(route("organizations.invite"),{users:a.map(t=>t.email)},{preserveScroll:!0,onSuccess:({props:{flash:t}})=>{l([]),s({title:"Succès",description:t.success})},onError:t=>console.error(t)})},N=(r,t)=>{n.post(route("organizations.settings.update.role"),{userId:r,role:t},{preserveScroll:!0,onSuccess:({props:{flash:d}})=>{s({title:"Succès",description:d.success})},onError:d=>console.error(d)})},w=r=>{n.delete(route("organizations.delete.user",{email:r}),{preserveScroll:!0,onSuccess:({props:{flash:t}})=>{s({title:"Succès",description:t.success})},onError:t=>{s({title:"Erreur",description:t[0]})}})};return e.jsxs(E,{children:[e.jsx(g,{title:"Gérer les membres",description:"Vous pouvez ajouter des collaborateurs à votre organisation en entrant leur adresse e-mail ci-dessous.",disabled:!a.length,children:e.jsx("ul",{role:"list",className:"divide-y divide-gray-100",children:o.organizationLogged.users.map(r=>e.jsx(B,{user:r,handleRoleChange:N,handleDeleteUser:w},r.email))})}),e.jsxs(g,{title:"Ajouter des membres",description:"Vous pouvez ajouter des membres à votre organisation en entrant leur adresse e-mail ci-dessous.",disabled:!a.length,onSubmit:b,children:[e.jsxs("div",{className:"flex items-center gap-x-4",children:[e.jsx(C,{placeholder:"Entrez une adresse e-mail",value:i,onChange:r=>{x(r.target.value),m("")},className:c?"border-red-500 focus:ring-red-500 animate-shake":""}),e.jsx(u,{type:"button",onClick:y,size:"icon",className:"rounded-full shrink-0",children:e.jsx(R,{className:"w-4 h-4"})})]}),c&&e.jsx("p",{className:"text-xs text-red-600",children:c}),e.jsx("ul",{role:"list",className:"divide-y divide-gray-100",children:a.map(r=>e.jsx(D,{user:r,handleRemoveUser:S},r.email))})]})]})},B=({user:s,handleRoleChange:o,handleDeleteUser:a})=>{var l;return e.jsxs("li",{className:"flex flex-col md:flex-row gap-3 md:justify-between md:items-center py-5",children:[e.jsxs("div",{className:"flex min-w-0 gap-x-2",children:[e.jsxs(j,{className:"h-12 w-12 flex-none rounded-full bg-gray-50 grid place-content-center",children:[e.jsx(f,{children:((l=s.name)==null?void 0:l.charAt(0).toUpperCase())||"A"}),e.jsx(v,{src:s.image})]}),e.jsxs("div",{className:"min-w-0 flex-auto",children:[e.jsx("p",{className:"text-sm font-semibold leading-6 text-gray-900",children:s.name||s.email}),e.jsx("p",{className:"mt-1 truncate text-xs leading-5 text-gray-500",children:s.name?s.email:"Cet utilisateur n’a pas encore complété son profil."})]})]}),e.jsxs("div",{className:"shrink-0 flex flex-col md:flex-row gap-2",children:[s.pivot.role!=="owner"&&e.jsxs(U,{defaultValue:s.pivot.role,onValueChange:i=>o(s.id,i),children:[e.jsx(V,{className:"w-full md:w-[140px]",children:e.jsx(L,{})}),e.jsx(T,{children:e.jsxs(F,{children:[e.jsx(h,{value:"member",children:"Membre"}),e.jsx(h,{value:"admin",children:"Administrateur"})]})})]}),e.jsx(u,{variant:"secondary",type:"button",onClick:()=>a(s.email),children:e.jsx(k,{className:"w-4 h-4"})})]})]},s.email)},D=({user:s,handleRemoveUser:o})=>{var a;return e.jsxs("li",{className:"flex justify-between items-center py-5",children:[e.jsxs("div",{className:"flex min-w-0 gap-x-2",children:[e.jsxs(j,{className:"h-12 w-12 flex-none rounded-full bg-gray-50 grid place-content-center",children:[e.jsx(f,{children:(a=s.name)==null?void 0:a.charAt(0).toUpperCase()}),e.jsx(v,{src:s.image})]}),e.jsxs("div",{className:"min-w-0 flex-auto",children:[e.jsx("p",{className:"text-sm font-semibold leading-6 text-gray-900",children:s.name||"Anonyme"}),e.jsx("p",{className:"mt-1 truncate text-xs leading-5 text-gray-500",children:s.name==="Anonyme"?`${s.email} • Cet utilisateur recevra un e-mail pour compléter son profil.`:s.email})]})]}),e.jsx(u,{variant:"secondary",size:"sm",onClick:()=>o(s.email),children:"Supprimer"})]},s.email)};export{ce as default};
